<?xml version="1.0" encoding="utf-8" ?>
<core:BasePage
    x:Class="MAUIsland.Mockup.MockupPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:app="clr-namespace:MAUIsland"
    xmlns:core="clr-namespace:MAUIsland.Core;assembly=MAUIsland.Core"
    xmlns:mockup="clr-namespace:MAUIsland.Mockup"
    xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
    x:Name="root"
    Title="MockupPage"
    Padding="8"
    x:DataType="mockup:MockupPageViewModel"
    BackgroundColor="Transparent">

    <core:BasePage.Resources>

        <FontImageSource
            x:Key="MockupPageExportMockupIcon"
            FontFamily="{x:Static core:FontNames.FluentSystemIconsRegular}"
            Glyph="{Static core:FluentUIIcon.Ic_fluent_phone_pagination_24_regular}"
            Color="{AppThemeBinding Light='#15161e',
                                    Dark='#eaeaea'}" />

        <DataTemplate x:Key="MockupPreviewItemContentView" x:DataType="mockup:MockupPreviewItemModel">
            <mockup:MockupPreviewItemContentView BindingContext="{x:Binding}" />
        </DataTemplate>

        <DataTemplate x:Key="AddButtonContentView" x:DataType="mockup:MockupPreviewItemModel">
            <mockup:AddButtonContentView BindingContext="{x:Binding}" ImageDrop="AddButton_ImageDropped" />
        </DataTemplate>

        <mockup:PreviewMockupDataTemplateSelector
            x:Key="PreviewMockupSelector"
            AddButton="{x:StaticResource AddButtonContentView}"
            Mockup="{x:StaticResource MockupPreviewItemContentView}" />

        <LinearItemsLayout
            x:Key="MockupPreviewItemLayout"
            ItemSpacing="16"
            Orientation="Horizontal" />

        <mockup:ListOfMockupPreviewItemModelToListStringConverter x:Key="ListOfMockupPreviewItemModelToListStringConverter" />
        <mockup:SelectedMockupPreviewItemModelToStringConverter x:Key="SelectedMockupPreviewItemModelToStringConverter" />
    </core:BasePage.Resources>

    <Grid ColumnDefinitions="2*,*" ColumnSpacing="8">
        <Border Padding="16" StrokeShape="RoundRectangle 8">
            <VerticalStackLayout>
                <CollectionView
                    ItemTemplate="{x:StaticResource PreviewMockupSelector}"
                    ItemsLayout="{x:StaticResource MockupPreviewItemLayout}"
                    ItemsSource="{x:Binding PreviewImages}"
                    SelectedItem="{x:Binding SelectedMockUp,
                                             Mode=TwoWay}"
                    SelectionMode="Single" />
                <Button
                    x:Name="RemoveAllMockUpButton"
                    Clicked="RemoveAllMockUpButton_Clicked"
                    HorizontalOptions="Center"
                    Text="Remove All" />
            </VerticalStackLayout>
        </Border>
        <Border
            Grid.Column="1"
            Padding="16"
            StrokeShape="RoundRectangle 8">
            <Grid
                BackgroundColor="Transparent"
                HorizontalOptions="Fill"
                RowDefinitions="auto, *"
                RowSpacing="8"
                VerticalOptions="Fill">
                <Grid
                    ColumnDefinitions="auto, auto"
                    ColumnSpacing="8"
                    HorizontalOptions="Center">
                    <Picker
                        Margin="8"
                        ItemsSource="{x:Binding MockupList}"
                        SelectedItem="{x:Binding CurrentMockupFrameState,
                                                 Mode=TwoWay}"
                        VerticalOptions="Fill" />
                    <Button
                        Grid.Column="1"
                        Padding="8,0,8,0"
                        BackgroundColor="Transparent"
                        Clicked="ExportMockUpButton_Clicked"
                        CornerRadius="4"
                        HorizontalOptions="Center"
                        ImageSource="{x:StaticResource MockupPageExportMockupIcon}"
                        Text="Export"
                        TextColor="{x:Static core:AppColors.White}"
                        VerticalOptions="Center" />
                </Grid>
                <Grid
                    Grid.Row="1"
                    toolkit:StateContainer.CanStateChange="{x:Binding CanMockupFrameChangeState,
                                                                      Mode=OneWay}"
                    toolkit:StateContainer.CurrentState="{x:Binding CurrentMockupFrameState,
                                                                    Mode=OneWay}"
                    HorizontalOptions="Fill"
                    VerticalOptions="Fill">
                    <toolkit:StateContainer.StateViews>
                        <core:Iphone13MiniContentView
                            x:Name="iPhone13MiniMockup"
                            toolkit:StateView.StateKey="iPhone 13 Mini"
                            ItemsSource="{x:Binding PreviewImages,
                                                    Mode=OneWay,
                                                    Converter={x:StaticResource ListOfMockupPreviewItemModelToListStringConverter}}"
                            SelectedMockUp="{x:Binding SelectedMockUp,
                                                       Mode=OneWay,
                                                       Converter={x:StaticResource SelectedMockupPreviewItemModelToStringConverter}}" />

                        <core:SamsungGalaxyS22UltraContentView
                            x:Name="SamsungGalaxyS22UltraMockup"
                            toolkit:StateView.StateKey="Samsung Galaxy S22 Ultra"
                            ItemsSource="{x:Binding PreviewImages,
                                                    Mode=OneWay,
                                                    Converter={x:StaticResource ListOfMockupPreviewItemModelToListStringConverter}}"
                            SelectedMockUp="{x:Binding SelectedMockUp,
                                                       Mode=OneWay,
                                                       Converter={x:StaticResource SelectedMockupPreviewItemModelToStringConverter}}" />

                        <core:GooglePixel6ProContentView
                            x:Name="GooglePixel6ProMockup"
                            toolkit:StateView.StateKey="Google Pixel 6 Pro"
                            ItemsSource="{x:Binding PreviewImages,
                                                    Mode=OneWay,
                                                    Converter={x:StaticResource ListOfMockupPreviewItemModelToListStringConverter}}"
                            SelectedMockUp="{x:Binding SelectedMockUp,
                                                       Mode=OneWay,
                                                       Converter={x:StaticResource SelectedMockupPreviewItemModelToStringConverter}}" />


                        <core:GooglePixel5ContentView
                            x:Name="GooglePixel5Mockup"
                            toolkit:StateView.StateKey="Google Pixel 5"
                            ItemsSource="{x:Binding PreviewImages,
                                                    Mode=OneWay,
                                                    Converter={x:StaticResource ListOfMockupPreviewItemModelToListStringConverter}}"
                            SelectedMockUp="{x:Binding SelectedMockUp,
                                                       Mode=OneWay,
                                                       Converter={x:StaticResource SelectedMockupPreviewItemModelToStringConverter}}" />
                    </toolkit:StateContainer.StateViews>
                </Grid>
            </Grid>
        </Border>
    </Grid>
</core:BasePage>